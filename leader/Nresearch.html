<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø±Ùƒ Ù†ÙØ­Ø§Øª Ø§Ù„Ø°ÙƒÙŠ - Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙˆØ­ÙŠÙŠÙ†</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #2d6a4f; /* Ø£Ø®Ø¶Ø± ØºØ§Ø¨Ø© Ø¯Ø§ÙØ¦ */
            --secondary-color: #40916c;
            --accent-gold: #b7903c; /* Ø°Ù‡Ø¨ÙŠ Ù‡Ø§Ø¯Ø¦ */
            --bg-color: #f9fbf9;
            --card-bg: #ffffff;
            --text-color: #2d3436;
            --border-color: #e9ecef;
            --input-bg: #f8f9fa;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --border-color: #333333;
            --input-bg: #2d2d2d;
            --accent-gold: #d4af37;
        }

        body { 
            margin: 0; padding: 10px; background: var(--bg-color); 
            font-family: 'Cairo', sans-serif; 
            display: flex; flex-direction: column; align-items: center; 
            min-height: 100vh; color: var(--text-color); transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .back-nav { width: 100%; max-width: 420px; margin-bottom: 15px; display: flex; }
        .btn-back { 
            background: var(--card-bg); border: 1.5px solid #d63031; padding: 10px 20px; 
            border-radius: 12px; cursor: pointer; color: #d63031; font-weight: 700; 
            text-decoration: none; font-size: 13px; transition: 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            display: flex; align-items: center; gap: 8px;
        }
        .btn-back:hover { background: #fff5f5; }

        .daily-card { 
            width: 100%; max-width: 420px; 
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
            color: white; padding: 18px; border-radius: 22px; margin-bottom: 20px; 
            text-align: center; font-size: 0.95em; box-sizing: border-box;
            box-shadow: 0 10px 20px rgba(45, 106, 79, 0.2);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .smart-card { 
            width: 100%; max-width: 420px; background: var(--card-bg); padding: 35px 25px; 
            border-radius: 35px; box-shadow: 0 20px 40px rgba(0,0,0,0.05); 
            border: 1px solid var(--border-color); text-align: center; margin-bottom: 20px; 
            box-sizing: border-box; position: relative;
        }
        
        h2 { color: var(--primary-color); font-size: 1.6em; margin: 0; font-weight: 900; }
        .sub-title { color: #636e72; font-size: 0.85em; margin-bottom: 25px; font-weight: 600; }
        
        input { 
            width: 100%; padding: 16px; border: 2px solid var(--border-color); 
            border-radius: 18px; font-size: 16px; box-sizing: border-box; outline: none; 
            text-align: center; background: var(--input-bg); color: var(--text-color);
            font-family: 'Cairo', sans-serif; transition: 0.3s;
        }
        input:focus { border-color: var(--primary-color); box-shadow: 0 0 0 4px rgba(45, 106, 79, 0.1); }

        select { 
            width: 100%; padding: 14px; border-radius: 15px; border: 2px solid var(--border-color); 
            background: var(--card-bg); color: var(--text-color); margin: 15px 0; 
            font-size: 15px; outline: none; text-align: center; font-family: 'Cairo', sans-serif;
            cursor: pointer;
        }

        .search-btn { 
            width: 100%; padding: 18px; 
            background: linear-gradient(135deg, var(--primary-color), #52b788); 
            color: white; border: none; border-radius: 18px; font-size: 1.1em; 
            font-weight: 800; cursor: pointer; transition: 0.3s;
            box-shadow: 0 8px 15px rgba(45, 106, 79, 0.2);
        }
        .search-btn:active { transform: scale(0.98); }

        .notes-card { 
            width: 100%; max-width: 420px; background: var(--card-bg); border-radius: 28px; 
            border-right: 6px solid var(--accent-gold); margin-bottom: 25px; 
            overflow: hidden; box-sizing: border-box; box-shadow: 0 10px 30px rgba(0,0,0,0.04);
        }
        .notes-header { background: var(--input-bg); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); }
        .notes-header h3 { margin: 0; font-size: 1rem; color: var(--primary-color); font-weight: 700; }
        .note-tools { display: flex; gap: 8px; }
        .tool-btn { 
            background: var(--card-bg); border: 1px solid var(--border-color); 
            padding: 8px 12px; border-radius: 10px; cursor: pointer; 
            color: var(--text-color); font-size: 13px; font-weight: 700; transition: 0.2s;
        }
        .tool-btn:hover { background: var(--primary-color); color: white; }
        .textarea-container { padding: 20px; }
        textarea { 
            width: 100%; height: 130px; border: none; font-family: 'Cairo', sans-serif; 
            font-size: 1.05em; resize: none; outline: none; background: transparent; 
            color: var(--text-color); line-height: 1.8; font-weight: 600;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¯Ø¹ÙˆÙŠØ© */
        #captureArea { 
            position: fixed; top: -10000px; left: 0;
            width: 500px; padding: 60px; background: #ffffff; 
            border: 25px solid var(--primary-color); text-align: center; 
            color: #333; z-index: -1; visibility: visible;
            font-family: 'Cairo', sans-serif;
        }
        #captureArea .watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-30deg); font-size: 60px; color: rgba(0,0,0,0.02); white-space: nowrap; font-weight: 900; }
        #captureArea h1 { color: var(--primary-color); font-size: 32px; margin-bottom: 5px; font-weight: 900; }
        #captureArea .badge { display: inline-block; padding: 6px 20px; background: #f8f9fa; border-radius: 8px; font-size: 14px; color: var(--accent-gold); margin-bottom: 40px; font-weight: 800; border: 1px solid #eee; }
        #captureArea p { font-size: 26px; line-height: 1.8; margin-bottom: 50px; white-space: pre-wrap; font-weight: 700; color: #2d3436; }
        .strict-disclaimer { background: #fffaf0; border: 1.5px solid #fee2e2; padding: 20px; border-radius: 15px; text-align: right; margin-bottom: 30px; }
        .strict-disclaimer p { font-size: 13px !important; color: #b91c1c !important; margin: 0 !important; line-height: 1.6 !important; font-weight: 800 !important; }
        #captureArea .link { font-size: 20px; color: var(--primary-color); font-weight: 900; border-top: 3px solid var(--accent-gold); padding-top: 20px; display: inline-block; }

        .theme-toggle { position: fixed; bottom: 25px; right: 25px; width: 55px; height: 55px; background: var(--primary-color); color: white; border-radius: 50%; border: none; cursor: pointer; z-index: 1000; font-size: 22px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        
        #customAlert { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 20000; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .alert-box { background: var(--card-bg); width: 85%; max-width: 340px; padding: 30px; border-radius: 30px; text-align: center; color: var(--text-color); box-shadow: 0 25px 50px rgba(0,0,0,0.3); border: 1px solid var(--border-color); }
        .alert-close { background: var(--primary-color); color: white; border: none; padding: 12px 30px; border-radius: 15px; font-weight: 800; cursor: pointer; width: 100%; margin-top: 25px; font-family: 'Cairo', sans-serif; }

        #smartOverlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.92); z-index: 10000; flex-direction: column; }
        .overlay-content { width: 96%; height: 94%; margin: auto; background: white; border-radius: 25px; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>

<div id="customAlert">
    <div class="alert-box">
        <div id="alertIcon" style="font-size: 4em; margin-bottom: 15px;">âœ¨</div>
        <p id="alertMsg" style="font-weight: 800; font-size: 1.15em; line-height: 1.5;"></p>
        <button class="alert-close" onclick="closeAlert()">Ø§Ø³ØªÙ…Ø±</button>
    </div>
</div>

<div id="captureArea">
    <div class="watermark">e-nafahat.github.io</div>
    <h1>ğŸŒ¿ Ù†ÙÙÙØ­ÙØ§ØªÙ Ø§Ù„ÙˆÙØ­Ù’ÙŠÙÙŠÙ’Ù†Ù</h1>
    <div class="badge">ØªØ£Ù…Ù„Ø§Øª Ø¥ÙŠÙ…Ø§Ù†ÙŠØ© Ù…ÙˆØ«Ù‚Ø©</div>
    
    <p id="targetText"></p>
    
    <div class="strict-disclaimer">
        <p>âš ï¸ ØªØ°ÙƒØ±Ø© Ù‡Ø§Ù…Ø©:</p>
        <p>Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙŠØ¹Ø¨Ø± Ø¹Ù† ØªØ£Ù…Ù„Ø§Øª Ø´Ø®ØµÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ ÙˆÙ„Ø§ ÙŠØ¹Ø¯ ÙØªÙˆÙ‰ Ø´Ø±Ø¹ÙŠØ© Ø±Ø³Ù…ÙŠØ©. Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ®Ù„ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØªÙ‡ Ø¹Ù† Ø£ÙŠ Ø³ÙˆØ¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ùˆ Ø§Ø³ØªØ´Ù‡Ø§Ø¯ ØºÙŠØ± Ø¯Ù‚ÙŠÙ‚.</p>
    </div>
    
    <div class="link">e-nafahat.github.io</div>
</div>

<div class="back-nav">
    <a href="home.html" class="btn-back">âœ– Ø¥ØºÙ„Ø§Ù‚ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø©</a>
</div>

<div class="daily-card" id="dailyCard"></div>

<div class="smart-card">
    <h2>ğŸ” Ø§Ù„Ø¨Ø§Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ</h2>
    <p class="sub-title">Ø§Ø³ØªØ®Ø±Ø¬ Ø¯Ø±Ø± Ø§Ù„ÙˆØ­ÙŠÙŠÙ† Ø¨Ù„Ù…Ø³Ø© ÙˆØ§Ø­Ø¯Ø©</p>
    <input type="text" id="userInput" placeholder="Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ´ØºÙ„ Ù‚Ù„Ø¨Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ">
    <select id="searchType">
        <option value="hadith">ğŸ“œ ÙƒÙ†ÙˆØ² Ø§Ù„Ø³Ù†Ø© (Ø§Ù„Ø¯Ø±Ø± Ø§Ù„Ø³Ù†ÙŠØ©)</option>
        <option value="quran">ğŸ“– Ø£Ù†ÙˆØ§Ø± Ø§Ù„Ù‚Ø±Ø¢Ù† (ØªÙ†Ø²ÙŠÙ„)</option>
    </select>
    <button class="search-btn" onclick="openSearch()">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†ÙØ­Ø§Øª ğŸš€</button>
</div>

<div class="notes-card">
    <div class="notes-header">
        <h3>ğŸ“ ÙÙÙŠÙ’Ø¶Ù Ø§Ù„Ø®ÙØ§Ø·ÙØ±Ù</h3>
        <div class="note-tools">
            <button class="tool-btn" onclick="exportAsImage()">ğŸ–¼ï¸ Ø¨Ø·Ø§Ù‚Ø©</button>
            <button class="tool-btn" onclick="copyNotes()">ğŸ“‹ Ù†Ø³Ø®</button>
            <button class="tool-btn" onclick="shareNafahat()">ğŸ’¬ Ù…Ø´Ø§Ø±ÙƒØ©</button>
        </div>
    </div>
    <div class="textarea-container">
        <textarea id="userNotes" placeholder="Ø³Ø¬Ù„ Ù‡Ù†Ø§ Ù…Ø§ ÙØ§Ø¶ Ø¨Ù‡ Ù‚Ù„Ø¨Ùƒ Ù…Ù† Ù‡Ø¯ÙŠ Ø§Ù„ÙˆØ­ÙŠÙŠÙ†..." oninput="saveNotes()"></textarea>
    </div>
</div>

<div id="smartOverlay">
    <div class="overlay-content">
        <div style="background:var(--primary-color); color:white; padding:18px 25px; display:flex; justify-content:space-between; align-items:center;">
            <span style="font-weight:900; font-size: 1.1em;">âœ¨ Ø±ÙÙŠØ§Ø¶Ù Ø§Ù„Ø¹ÙÙ„Ù’Ù…Ù</span>
            <button onclick="closeSearch()" style="background:#fff; border:none; padding:8px 20px; border-radius:12px; color:var(--primary-color); font-weight:900; cursor:pointer; font-family:'Cairo';">Ø¥ØºÙ„Ø§Ù‚ âœ–</button>
        </div>
        <iframe id="searchIframe" style="flex-grow:1; border:none; background: white;"></iframe>
    </div>
</div>

<script>
    const dailyReflections = [
        "ğŸ’¡ ØªØ£Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…: 'Ø£ÙÙ„ÙØ§ Ø¨ÙØ°ÙÙƒÙ’Ø±Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ØªÙØ·Ù’Ù…ÙØ¦ÙÙ†Ù‘Ù Ø§Ù„Ù’Ù‚ÙÙ„ÙÙˆØ¨Ù' - Ø§Ù„Ø³ÙƒÙŠÙ†Ø© ØªØ¨Ø¯Ø£ Ù…Ù† Ù‡Ù†Ø§.",
        "ğŸ’¡ ØªØ£Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…: 'ÙˆÙÙ…ÙÙ† ÙŠÙØªÙ‘ÙÙ‚Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙŠÙØ¬Ù’Ø¹ÙÙ„ Ù„Ù‘ÙÙ‡Ù Ù…ÙØ®Ù’Ø±ÙØ¬Ù‹Ø§' - Ø§Ù„ÙŠÙ‚ÙŠÙ† Ù‡Ùˆ Ø§Ù„Ù…ÙØªØ§Ø­.",
        "ğŸ’¡ ØªØ£Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…: 'Ø¥ÙÙ†Ù‘Ù Ù…ÙØ¹Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§' - Ø¶ÙˆØ¡ Ø§Ù„ÙØ±Ø¬ ÙŠÙ‚ØªØ±Ø¨ Ø¯Ø§Ø¦Ù…Ø§Ù‹.",
        "ğŸ’¡ ØªØ£Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…: 'ÙˆÙØ£ÙØ­Ù’Ø³ÙÙ†ÙÙˆØ§ Ø¥ÙÙ†Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙŠÙØ­ÙØ¨Ù‘Ù Ø§Ù„Ù’Ù…ÙØ­Ù’Ø³ÙÙ†ÙÙŠÙ†Ù' - Ø§Ù„Ø¥Ø­Ø³Ø§Ù† Ù„ØºØ© Ù„Ø§ ØªØ®Ø·Ø¦Ù‡Ø§ Ø§Ù„Ù‚Ù„ÙˆØ¨."
    ];
    
    window.onload = function() {
        document.getElementById('dailyCard').innerHTML = dailyReflections[Math.floor(Math.random() * dailyReflections.length)];
        const saved = localStorage.getItem('nafahat_notes');
        if(saved) document.getElementById('userNotes').value = saved;
        if(localStorage.getItem('nafahat_theme') === 'dark') document.body.setAttribute('data-theme', 'dark');
    }

    function saveNotes() { localStorage.setItem('nafahat_notes', document.getElementById('userNotes').value); }

    function showAlert(msg, icon = "âœï¸") {
        document.getElementById('alertMsg').innerText = msg;
        document.getElementById('alertIcon').innerText = icon;
        document.getElementById('customAlert').style.display = 'flex';
    }

    function closeAlert() { document.getElementById('customAlert').style.display = 'none'; }

    function exportAsImage() {
        const text = document.getElementById('userNotes').value.trim();
        const forbiddenWords = ["ÙØªÙˆÙ‰", "Ø­Ù„Ø§Ù„", "Ø­Ø±Ø§Ù…"]; 
        if(forbiddenWords.some(w => text.includes(w))) {
            return showAlert("ØªÙ†Ø¨ÙŠÙ‡: Ù†Ø¹ØªØ°Ø± Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØµØ·Ù„Ø­Ø§Øª Ø§Ù„ÙØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø®ÙˆØ§Ø·Ø± Ø§Ù„Ø´Ø®ØµÙŠØ©.", "ğŸ›‘");
        }
        if(!text) return showAlert("Ø§Ù„Ù…ÙÙƒØ±Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ø± ÙƒÙ„Ù…Ø§ØªÙƒ Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ø£ÙˆÙ„Ø§Ù‹!", "ğŸ’¡");

        showAlert("Ù„Ø­Ø¸Ø§Øª... Ù†ØµÙ…Ù… Ù„Ùƒ Ø¨Ø·Ø§Ù‚Ø© ØªÙ„ÙŠÙ‚ Ø¨ØªØ£Ù…Ù„Ø§ØªÙƒ", "â³");
        const target = document.getElementById('captureArea');
        document.getElementById('targetText').innerText = text;

        setTimeout(() => {
            html2canvas(target, {
                useCORS: true,
                backgroundColor: "#ffffff",
                scale: 2,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Nafahat_Card_' + Date.now() + '.png';
                link.href = canvas.toDataURL("image/png");
                link.click();
                closeAlert();
                showAlert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­ ÙÙŠ Ù…Ø¹Ø±Ø¶ ØµÙˆØ±Ùƒ.", "âœ…");
            }).catch(e => {
                closeAlert();
                showAlert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¨Ø³ÙŠØ·ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.");
            });
        }, 800);
    }

    function copyNotes() {
        const text = document.getElementById('userNotes').value.trim();
        if(!text) return showAlert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Øµ Ù„Ù†Ø³Ø®Ù‡!");
        navigator.clipboard.writeText(text);
        showAlert("ØªÙ… Ù†Ø³Ø® ÙƒÙ„Ù…Ø§ØªÙƒ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø¨Ù†Ø¬Ø§Ø­", "âœ…");
    }

    function shareNafahat() {
        const text = document.getElementById('userNotes').value.trim();
        if(!text) return showAlert("Ø§Ù„Ù…ÙÙƒØ±Ø© ÙØ§Ø±ØºØ©!");
        if (navigator.share) {
            navigator.share({ 
                title: 'Ù†ÙØ­Ø§Øª Ø§Ù„ÙˆØ­ÙŠÙŠÙ†',
                text: text 
            }).catch(() => {});
        } else {
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`);
        }
    }

    function toggleTheme() {
        const isDark = document.body.getAttribute('data-theme') === 'dark';
        document.body.setAttribute('data-theme', isDark ? 'light' : 'dark');
        localStorage.setItem('nafahat_theme', isDark ? 'light' : 'dark');
    }

    function openSearch() {
        const query = document.getElementById('userInput').value.trim();
        const type = document.getElementById('searchType').value;
        if (!query) return showAlert("Ø£Ø®Ø¨Ø±Ù†ÙŠ.. Ø¹Ù† Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ¨Ø­Ø«ØŸ");
        let targetUrl = type === "hadith" ? `https://dorar.net/hadith/search?q=${encodeURIComponent(query)}&st=p&d[]=1` : `https://tanzil.net/#search/quran/${encodeURIComponent(query)}`;
        document.getElementById('searchIframe').src = targetUrl;
        document.getElementById('smartOverlay').style.display = 'flex';
    }

    function closeSearch() { 
        document.getElementById('smartOverlay').style.display = 'none'; 
        document.getElementById('searchIframe').src = ''; 
    }
</script>
</body>
</html>
