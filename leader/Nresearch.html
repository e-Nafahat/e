<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* ØªØµÙ…ÙŠÙ… Ù…Ø®ØµØµ Ù„Ù„Ù‡ÙˆØ§ØªÙ */
        .search-card {
            background: #ffffff;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid #eee;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }
        .quran-theme { border-right: 5px solid #27ae60; background: #f9fffb; }
        .hadith-theme { border-right: 5px solid #2980b9; background: #f5faff; }
        
        #searchInput:focus {
            border-color: #27ae60 !important;
            box-shadow: 0 0 8px rgba(39, 174, 96, 0.2);
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        #searchResults::-webkit-scrollbar { width: 4px; }
        #searchResults::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
    </style>
</head>
<body style="margin: 0; background-color: #f4f7f6;">

<div id="nafahat-search-container" style="max-width: 100%; margin: 10px; padding: 15px; border-radius: 20px; background: #ffffff; box-shadow: 0 10px 25px rgba(0,0,0,0.08);">
    
    <div style="text-align: center; margin-bottom: 20px;">
        <h2 style="color: #2c3e50; font-size: 1.4em; margin-bottom: 5px;">ğŸ” Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†ÙŠ</h2>
        <p style="color: #7f8c8d; font-size: 0.85em;">Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙˆØ­ÙŠÙŠÙ† (Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ§Ù„Ø³Ù†Ø©)</p>
    </div>

    <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px;">
        <input type="text" id="searchInput" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ø¨Ø­Ø« Ù‡Ù†Ø§..." 
               style="width: 100%; padding: 16px; border: 2px solid #eee; border-radius: 12px; outline: none; font-size: 16px; box-sizing: border-box;">
        
        <button onclick="performGlobalSearch()" 
                style="width: 100%; padding: 14px; background: #27ae60; color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1.1em; active: transform: scale(0.98);">
            Ø¨Ù€Ø­Ù€Ø« Ø§Ù„Ø¢Ù†
        </button>
    </div>

    <div id="resultsLoader" style="display: none; text-align: center; padding: 15px; color: #27ae60;">
        âœ¨ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...
    </div>

    <div id="searchResults" style="margin-top: 10px;">
        </div>
</div>

<script>
async function performGlobalSearch() {
    const query = document.getElementById('searchInput').value.trim();
    const resultsContainer = document.getElementById('searchResults');
    const loader = document.getElementById('resultsLoader');

    if (!query) return;

    resultsContainer.innerHTML = '';
    loader.style.display = 'block';

    try {
        const quranUrl = `https://api.alquran.cloud/v1/search/${encodeURIComponent(query)}/all/ar`;
        const hadithUrl = `https://hadis-api-id.vercel.app/hadith/search?query=${encodeURIComponent(query)}`;

        const [quranRes, hadithRes] = await Promise.allSettled([
            fetch(quranUrl).then(res => res.json()),
            fetch(hadithUrl).then(res => res.json())
        ]);

        loader.style.display = 'none';
        let html = '';

        // Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù‚Ø±Ø¢Ù† - Ø¨Ø·Ø§Ù‚Ø§Øª Ø®Ø¶Ø±Ø§Ø¡
        if (quranRes.status === 'fulfilled' && quranRes.value.data && quranRes.value.data.results.length > 0) {
            html += `<h4 style="color: #27ae60; margin: 15px 5px 10px;">ğŸ“– Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…:</h4>`;
            quranRes.value.data.results.slice(0, 5).forEach(verse => {
                html += `
                    <div class="search-card quran-theme">
                        <p style="font-size: 1.1em; color: #2c3e50; line-height: 1.6; margin: 0 0 10px 0;">${verse.text}</p>
                        <div style="font-size: 0.8em; color: #27ae60; font-weight: bold;">Ø³ÙˆØ±Ø© ${verse.surah.name} : Ø¢ÙŠØ© ${verse.numberInSurah}</div>
                    </div>`;
            });
        }

        // Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ù†Ø© - Ø¨Ø·Ø§Ù‚Ø§Øª Ø²Ø±Ù‚Ø§Ø¡
        if (hadithRes.status === 'fulfilled' && hadithRes.value.items && hadithRes.value.items.length > 0) {
            html += `<h4 style="color: #2980b9; margin: 20px 5px 10px;">ğŸ“œ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©:</h4>`;
            hadithRes.value.items.slice(0, 5).forEach(item => {
                html += `
                    <div class="search-card hadith-theme">
                        <p style="font-size: 1em; color: #34495e; line-height: 1.6; margin: 0 0 10px 0;">${item.arab}</p>
                        <div style="font-size: 0.8em; color: #3498db;">Ø§Ù„Ù…ØµØ¯Ø±: ${item.path}</div>
                    </div>`;
            });
        }

        resultsContainer.innerHTML = html || '<p style="text-align:center; padding: 20px;">Ù„Ù… Ù†Ø¬Ø¯ Ù†ØªØ§Ø¦Ø¬ØŒ Ø­Ø§ÙˆÙ„ Ø¨ÙƒÙ„Ù…Ø© Ø£Ø®Ø±Ù‰.</p>';

    } catch (e) {
        loader.style.display = 'none';
        resultsContainer.innerHTML = '<p style="color:red; text-align:center;">Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.</p>';
    }
}
</script>
</body>
</html>
