<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØµØ­Ø­ Ù†ÙØ­Ø§Øª | Ø§Ù„ÙØ±ØµØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: sans-serif; background: #fdfaf1; text-align: center; padding: 20px; }
        .card { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 2px solid #e0d5b1; max-width: 400px; margin: auto; }
        #display { font-family: 'Amiri', serif; font-size: 2.5rem; margin: 20px 0; min-height: 100px; line-height: 1.6; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .word { color: #ccc; transition: 0.3s; }
        .word.matched { color: #1a5d1a; font-weight: bold; transform: scale(1.1); }
        .btn { background: #1a5d1a; color: white; border: none; padding: 20px; border-radius: 15px; font-size: 1.3rem; width: 100%; cursor: pointer; font-weight: bold; }
        .btn.active { background: #e74c3c; }
        #log { font-size: 0.8rem; color: #888; margin-top: 15px; background: #eee; padding: 10px; border-radius: 8px; word-break: break-all; }
    </style>
</head>
<body>

<div class="card">
    <h2 style="color: #b8860b;">Ù…ØµØ­Ø­ Ù†ÙØ­Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</h2>
    <p>Ù‚Ù„ Ø¨ÙˆØ¶ÙˆØ­: <b>Ù‚Ù„ Ù‡Ùˆ Ø§Ù„Ù„Ù‡ Ø§Ø­Ø¯</b></p>
    
    <div id="display">
        <span id="s0" class="word">Ù‚Ù„</span>
        <span id="s1" class="word">Ù‡Ùˆ</span>
        <span id="s2" class="word">Ø§Ù„Ù„Ù‡</span>
        <span id="s3" class="word">Ø§Ø­Ø¯</span>
    </div>
    
    <button id="btn" class="btn">ğŸ¤ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ø¢Ù†</button>
    <div id="log">Ø§Ù„Ø­Ø§Ù„Ø©: Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨Ø¯Ø¡</div>
</div>

<script>
    const btn = document.getElementById('btn');
    const log = document.getElementById('log');
    const target = ["Ù‚Ù„", "Ù‡Ùˆ", "Ø§Ù„Ù„Ù‡", "Ø§Ø­Ø¯"];
    let recognition;

    // Ø¯Ø§Ù„Ø© ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ù‡Ù…Ø²Ø§Øª ÙˆØ§Ù„ØªØ´ÙƒÙŠÙ„ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© 100%
    const clean = (t) => t.replace(/[Ø£Ø¥Ø¢]/g, "Ø§").replace(/Ø©/g, "Ù‡").replace(/[\u064B-\u065F]/g, "").trim();

    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = 'ar-SA';
        recognition.continuous = true;
        recognition.interimResults = true;

        btn.onclick = () => {
            if (btn.classList.contains('active')) {
                recognition.stop();
            } else {
                recognition.start();
            }
        };

        recognition.onstart = () => {
            btn.classList.add('active');
            btn.innerText = "ğŸ›‘ ØªÙˆÙ‚Ù";
            log.innerText = "Ø£Ø³Ù…Ø¹Ùƒ Ø§Ù„Ø¢Ù†... ØªÙƒÙ„Ù…";
        };

        recognition.onresult = (event) => {
            let heardText = "";
            for (let i = event.resultIndex; i < event.results.length; ++i) {
                heardText += event.results[i][0].transcript;
            }
            
            log.innerText = "Ø³Ù…Ø¹Øª: " + heardText;
            const finalHeard = clean(heardText);

            target.forEach((word, index) => {
                if (finalHeard.includes(clean(word))) {
                    document.getElementById('s' + index).className = 'word matched';
                }
            });
        };

        recognition.onend = () => {
            btn.classList.remove('active');
            btn.innerText = "ğŸ¤ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ø¢Ù†";
            if (!log.innerText.includes("Ø³Ù…Ø¹Øª")) log.innerText = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ø¯ÙˆÙ† Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØª.";
        };

        recognition.onerror = (e) => {
            log.innerText = "Ø®Ø·Ø£: " + e.error;
        };
    } else {
        log.innerText = "Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ";
    }
</script>
</body>
</html>
