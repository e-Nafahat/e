<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØµØ­Ø­ Ù†ÙØ­Ø§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: sans-serif; background: #fdfaf1; text-align: center; padding: 20px; }
        .card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-width: 400px; margin: auto; border: 1px solid #e0d5b1; }
        #display { font-family: 'Amiri', serif; font-size: 2.8rem; margin: 20px 0; min-height: 80px; }
        .word { color: #ccc; margin: 0 5px; transition: 0.3s; }
        .word.ok { color: #2ecc71; font-weight: bold; transform: scale(1.1); display: inline-block; }
        .btn { background: #1a5d1a; color: white; border: none; padding: 18px; border-radius: 12px; font-size: 1.2rem; width: 100%; cursor: pointer; font-weight: bold; }
        #status { font-size: 0.8rem; color: #999; margin-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h3 style="color: #b8860b; margin: 0 0 15px 0;">Ù…ØµØ­Ø­ Ù†ÙØ­Ø§Øª</h3>
    <div id="display">
        <span id="w0" class="word">Ù‚Ù„</span>
        <span id="w1" class="word">Ù‡Ùˆ</span>
        <span id="w2" class="word">Ø§Ù„Ù„Ù‡</span>
        <span id="w3" class="word">Ø§Ø­Ø¯</span>
    </div>
    <button id="btn" class="btn">ğŸ¤ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ù…ÙŠØ¹</button>
    <div id="status">Ø§Ø¶ØºØ· ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„ÙƒÙ„Ø§Ù… Ø¨ÙˆØ¶ÙˆØ­</div>
</div>

<script>
    const btn = document.getElementById('btn');
    const status = document.getElementById('status');
    const target = ["Ù‚Ù„", "Ù‡Ùˆ", "Ø§Ù„Ù„Ù‡", "Ø§Ø­Ø¯"];
    let recognition;

    if ('webkitSpeechRecognition' in window) {
        recognition = new webkitSpeechRecognition();
        recognition.lang = 'ar-SA';
        recognition.continuous = true;
        recognition.interimResults = true;

        btn.onclick = () => {
            try { recognition.start(); } catch(e) { recognition.stop(); }
        };

        recognition.onstart = () => { 
            btn.style.background = "red"; btn.innerText = "ğŸ›‘ ØªÙˆÙ‚Ù";
            status.innerText = "Ø£Ø³Ù…Ø¹Ùƒ Ø§Ù„Ø¢Ù†... Ø§Ù‚Ø±Ø£ (Ù‚Ù„ Ù‡Ùˆ Ø§Ù„Ù„Ù‡ Ø§Ø­Ø¯)";
        };

        recognition.onresult = (event) => {
            let heard = "";
            for (let i = event.resultIndex; i < event.results.length; ++i) {
                heard += event.results[i][0].transcript;
            }
            
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ù†Ø·ÙˆÙ‚ Ù…Ù† Ø§Ù„Ù‡Ù…Ø²Ø§Øª ÙˆØ§Ù„ØªØ´ÙƒÙŠÙ„ ØªÙ…Ø§Ù…Ø§
            const clean = (t) => t.replace(/[Ø£Ø¥Ø¢]/g, "Ø§").replace(/Ø©/g, "Ù‡").replace(/[\u064B-\u065F]/g, "");
            const finalHeard = clean(heard);

            target.forEach((word, i) => {
                if (finalHeard.includes(clean(word))) {
                    document.getElementById('w' + i).className = 'word ok';
                }
            });
        };

        recognition.onend = () => { 
            btn.style.background = "#1a5d1a"; btn.innerText = "ğŸ¤ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ù…ÙŠØ¹";
            status.innerText = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹.";
        };
    }
</script>
</body>
</html>
